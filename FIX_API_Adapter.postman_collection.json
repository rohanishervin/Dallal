{
	"info": {
		"_postman_id": "b8c4d7e1-4a89-4c2b-9f14-8d7e6f3a2b5c",
		"name": "FIX API Adapter - Complete Collection",
		"description": "Complete Postman collection for testing FIX API Adapter endpoints.\n\n## Authentication Flow\n1. First run **Login** to get JWT token\n2. Token is automatically saved to environment variable `auth_token`\n3. All protected endpoints use this token automatically\n\n## Available Endpoints\n- Authentication (login)\n- Session management (status, logout)\n- Market data (instruments, historical bars)\n- **NEW: WebSocket orderbook streaming**\n- Health checks\n\n## Environment Variables\n- `base_url`: API base URL (default: http://localhost:8000)\n- `ws_base_url`: WebSocket base URL (default: ws://localhost:8000)\n- `auth_token`: JWT token (auto-set after login)\n- `username`: Your FIX username\n- `password`: Your FIX password\n- `device_id`: Optional device identifier\n\n## New in this version\n- **WebSocket Orderbook**: Real-time orderbook streaming with subscription management\n- **Historical Bars**: Get OHLCV price data with configurable time periods\n- **Multiple timeframes**: Support for S1, S10, M1, M5, M15, M30, H1, H4, D1, W1, MN1\n- **Bid/Ask pricing**: Choose between Bid or Ask prices\n- **Comprehensive validation**: Proper error handling and data validation\n\n## WebSocket Usage\nUse external WebSocket clients (e.g., WebSocket King, wscat) to connect:\n```\nws://localhost:8000/ws/orderbook?token=YOUR_JWT_TOKEN\n```\nSend JSON messages:\n```json\n{\"type\": \"subscribe\", \"symbol\": \"EUR/USD\", \"levels\": 5}\n{\"type\": \"unsubscribe\", \"symbol\": \"EUR/USD\"}\n```",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "12345678"
	},
	"item": [
		{
			"name": "üîê Authentication",
			"item": [
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Test response status",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Parse response",
									"const response = pm.response.json();",
									"",
									"// Test response structure",
									"pm.test(\"Response has required fields\", function () {",
									"    pm.expect(response).to.have.property('success');",
									"    pm.expect(response).to.have.property('message');",
									"});",
									"",
									"// If login successful, save token",
									"if (response.success && response.token) {",
									"    pm.test(\"Login successful\", function () {",
									"        pm.expect(response.success).to.be.true;",
									"        pm.expect(response.token).to.be.a('string');",
									"    });",
									"    ",
									"    // Save token to environment variable",
									"    pm.environment.set(\"auth_token\", response.token);",
									"    console.log(\"‚úÖ Auth token saved:\", response.token.substring(0, 20) + \"...\");",
									"} else {",
									"    pm.test(\"Login failed as expected\", function () {",
									"        pm.expect(response.success).to.be.false;",
									"        pm.expect(response.error).to.be.a('string');",
									"    });",
									"    console.log(\"‚ùå Login failed:\", response.error);",
									"}",
									"",
									"// Log response for debugging",
									"console.log(\"üìã Full response:\", JSON.stringify(response, null, 2));"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"// Clear any existing token before login",
									"pm.environment.unset(\"auth_token\");",
									"console.log(\"üîÑ Starting fresh login attempt...\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"{{username}}\",\n  \"password\": \"{{password}}\",\n  \"device_id\": \"{{device_id}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"login"
							]
						},
						"description": "Authenticate user with FIX credentials and receive JWT token.\n\n**Rate Limited**: 5 attempts per minute per IP\n\n**Creates dual FIX sessions**:\n- Trade session (port 5004)\n- Feed session (port 5005)\n\n**Environment Variables Required**:\n- `username`: Your FIX trading username\n- `password`: Your FIX trading password\n- `device_id`: Optional device identifier"
					},
					"response": [
						{
							"name": "Successful Login",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"username\": \"trader123\",\n  \"password\": \"password123\",\n  \"device_id\": \"postman_testing\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/auth/login",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"auth",
										"login"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0cmFkZXIxMjMiLCJpYXQiOjE2NDA5OTUyMDAuMCwiZXhwIjoxNjQwOTk4ODAwLjAsImp0aSI6IjEyMzQ1Njc4LTkwYWItY2RlZi0xMjM0LTU2Nzg5MGFiY2RlZiJ9.example_signature\",\n    \"message\": \"Login successful\"\n}"
						},
						{
							"name": "Failed Login",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"username\": \"invalid\",\n  \"password\": \"wrong\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/auth/login",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"auth",
										"login"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": false,\n    \"error\": \"Invalid credentials\",\n    \"message\": \"Login failed\"\n}"
						}
					]
				}
			],
			"description": "Authentication endpoints for user login and JWT token management."
		},
		{
			"name": "üìä Session Management",
			"item": [
				{
					"name": "Get Session Status",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Test response status",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Parse response",
									"const response = pm.response.json();",
									"",
									"// Test response structure",
									"pm.test(\"Response has required fields\", function () {",
									"    pm.expect(response).to.have.property('success');",
									"    pm.expect(response).to.have.property('session');",
									"    pm.expect(response).to.have.property('message');",
									"});",
									"",
																	"// Test session object",
								"pm.test(\"Session object is valid\", function () {",
								"    pm.expect(response.session).to.have.property('user_id');",
								"    pm.expect(response.session).to.have.property('overall_active');",
								"});",
								"",
								"// Log session info",
								"if (response.session.overall_active) {",
								"    console.log(\"‚úÖ Active sessions:\", response.message);",
								"    ",
								"    // Log Trade session details",
								"    if (response.session.trade_session) {",
								"        const trade = response.session.trade_session;",
								"        console.log(\"üìä Trade Session:\");",
								"        console.log(\"  - Active:\", trade.is_active);",
								"        console.log(\"  - Age:\", trade.session_age_seconds, \"seconds\");",
								"        console.log(\"  - Heartbeat:\", trade.heartbeat_status);",
								"        console.log(\"  - Last heartbeat:\", trade.last_heartbeat || 'Never');",
								"    }",
								"    ",
								"    // Log Feed session details",
								"    if (response.session.feed_session) {",
								"        const feed = response.session.feed_session;",
								"        console.log(\"üìà Feed Session:\");",
								"        console.log(\"  - Active:\", feed.is_active);",
								"        console.log(\"  - Age:\", feed.session_age_seconds, \"seconds\");",
								"        console.log(\"  - Heartbeat:\", feed.heartbeat_status);",
								"        console.log(\"  - Last heartbeat:\", feed.last_heartbeat || 'Never');",
								"    }",
								"} else {",
								"    console.log(\"‚ùå No active sessions found\");",
								"}",
								"",
								"console.log(\"üìã Full session details:\", JSON.stringify(response.session, null, 2));"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/session/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"session",
								"status"
							]
						},
						"description": "Get current session status including both Trade and Feed sessions.\n\n**Authentication Required**: JWT token in Authorization header\n\n**Returns**:\n- Session activity status\n- Creation time and last activity\n- Session age in seconds\n- Which sessions are active (Trade/Feed)"
					},
					"response": [
						{
							"name": "Active Sessions",
							"originalRequest": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									}
								],
								"url": {
									"raw": "{{base_url}}/session/status",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"session",
										"status"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"session\": {\n        \"user_id\": \"trader123\",\n        \"overall_active\": true,\n        \"trade_session\": {\n            \"connection_type\": \"trade\",\n            \"is_active\": true,\n            \"created_at\": \"2023-12-01T10:30:00Z\",\n            \"last_activity\": \"2023-12-01T10:35:00Z\",\n            \"last_heartbeat\": \"2023-12-01T10:35:30Z\",\n            \"session_age_seconds\": 300,\n            \"heartbeat_status\": \"healthy\"\n        },\n        \"feed_session\": {\n            \"connection_type\": \"feed\",\n            \"is_active\": true,\n            \"created_at\": \"2023-12-01T10:30:05Z\",\n            \"last_activity\": \"2023-12-01T10:35:05Z\",\n            \"last_heartbeat\": \"2023-12-01T10:35:35Z\",\n            \"session_age_seconds\": 295,\n            \"heartbeat_status\": \"healthy\"\n        }\n    },\n    \"message\": \"Trade session active (heartbeat: healthy), Feed session active (heartbeat: healthy)\"\n}"
						}
					]
				},
				{
					"name": "Logout Session",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Test response status",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Parse response",
									"const response = pm.response.json();",
									"",
									"// Test response structure",
									"pm.test(\"Response has required fields\", function () {",
									"    pm.expect(response).to.have.property('success');",
									"    pm.expect(response).to.have.property('message');",
									"});",
									"",
									"// Test logout success",
									"pm.test(\"Logout successful\", function () {",
									"    pm.expect(response.success).to.be.true;",
									"});",
									"",
									"console.log(\"üîì Logout result:\", response.message);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/session/logout",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"session",
								"logout"
							]
						},
						"description": "Logout and cleanup both Trade and Feed FIX sessions.\n\n**Authentication Required**: JWT token in Authorization header\n\n**Actions**:\n- Sends proper FIX logout messages\n- Closes SSL connections\n- Removes sessions from memory\n- Stops heartbeat monitoring"
					},
					"response": [
						{
							"name": "Successful Logout",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									}
								],
								"url": {
									"raw": "{{base_url}}/session/logout",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"session",
										"logout"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"message\": \"Trade session, Feed session logged out successfully\"\n}"
						}
					]
				}
			],
			"description": "Session management endpoints for monitoring and controlling FIX sessions."
		},
		{
			"name": "üìà Market Data",
			"item": [
				{
					"name": "Get Trading Instruments",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Test response status",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Parse response",
									"const response = pm.response.json();",
									"",
									"// Test response structure",
									"pm.test(\"Response has required fields\", function () {",
									"    pm.expect(response).to.have.property('success');",
									"    pm.expect(response).to.have.property('request_id');",
									"    pm.expect(response).to.have.property('symbols');",
									"});",
									"",
									"// Test if request was successful",
									"if (response.success) {",
									"    pm.test(\"Security list retrieved successfully\", function () {",
									"        pm.expect(response.success).to.be.true;",
									"        pm.expect(response.symbols).to.be.an('array');",
									"    });",
									"    ",
									"    console.log(\"‚úÖ Retrieved\", response.symbols.length, \"trading instruments\");",
									"    console.log(\"üìä Request ID:\", response.request_id);",
									"    ",
									"    // Log first few symbols",
									"    if (response.symbols.length > 0) {",
									"        console.log(\"üìã Sample instruments:\");",
									"        response.symbols.slice(0, 5).forEach((symbol, index) => {",
									"            console.log(`${index + 1}. ${symbol.symbol} - ${symbol.description || 'No description'}`);",
									"        });",
									"    }",
									"} else {",
									"    pm.test(\"Request failed as expected\", function () {",
									"        pm.expect(response.success).to.be.false;",
									"        pm.expect(response.error).to.be.a('string');",
									"    });",
									"    console.log(\"‚ùå Request failed:\", response.error);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/market/instruments",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"market",
								"instruments"
							]
						},
						"description": "Get list of available trading instruments via FIX Security List Request.\n\n**Authentication Required**: JWT token in Authorization header\n\n**FIX Message**: Security List Request (x)\n**Connection Used**: Feed session (port 5005)\n\n**Returns**:\n- List of tradeable symbols\n- Symbol metadata (currency, description, etc.)\n- Request/response IDs for tracking"
					},
					"response": [
						{
							"name": "Successful Instruments List",
							"originalRequest": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									}
								],
								"url": {
									"raw": "{{base_url}}/market/instruments",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"market",
										"instruments"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"request_id\": \"SLR_1640995200000\",\n    \"response_id\": \"server_response_id\",\n    \"symbols\": [\n        {\n            \"symbol\": \"EUR/USD\",\n            \"security_id\": \"EURUSD\",\n            \"currency\": \"EUR\",\n            \"settle_currency\": \"USD\",\n            \"trade_enabled\": true,\n            \"description\": \"Euro vs US Dollar\"\n        },\n        {\n            \"symbol\": \"GBP/USD\",\n            \"security_id\": \"GBPUSD\",\n            \"currency\": \"GBP\",\n            \"settle_currency\": \"USD\",\n            \"trade_enabled\": true,\n            \"description\": \"British Pound vs US Dollar\"\n        }\n    ],\n    \"message\": \"Retrieved 25 trading instruments\",\n    \"timestamp\": \"2023-12-01T10:30:00Z\"\n}"
						}
					]
				},
				{
					"name": "Get Historical Bars",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Test response status",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Parse response",
									"const response = pm.response.json();",
									"",
									"// Test response structure",
									"pm.test(\"Response has required fields\", function () {",
									"    pm.expect(response).to.have.property('success');",
									"    pm.expect(response).to.have.property('symbol');",
									"    pm.expect(response).to.have.property('period_id');",
									"    pm.expect(response).to.have.property('bars');",
									"});",
									"",
									"// Test if request was successful",
									"if (response.success) {",
									"    pm.test(\"Historical bars retrieved successfully\", function () {",
									"        pm.expect(response.success).to.be.true;",
									"        pm.expect(response.bars).to.be.an('array');",
									"    });",
									"    ",
									"    console.log(\"‚úÖ Retrieved\", response.bars.length, \"historical bars for\", response.symbol);",
									"    console.log(\"üìä Period:\", response.period_id, \"| Price Type:\", response.price_type);",
									"    console.log(\"üìä Request ID:\", response.request_id || 'Not provided');",
									"    ",
									"    // Log date range if available",
									"    if (response.data_from && response.data_to) {",
									"        console.log(\"üìÖ Data Range: \", response.data_from, \"to\", response.data_to);",
									"    }",
									"    ",
									"    // Log first few bars",
									"    if (response.bars.length > 0) {",
									"        console.log(\"üìã Sample bars:\");",
									"        response.bars.slice(0, 3).forEach((bar, index) => {",
									"            console.log(`${index + 1}. ${bar.timestamp}: O=${bar.open_price} H=${bar.high_price} L=${bar.low_price} C=${bar.close_price}`);",
									"        });",
									"        ",
									"        // Validate bar structure",
									"        pm.test(\"Bar data structure is valid\", function () {",
									"            const firstBar = response.bars[0];",
									"            pm.expect(firstBar).to.have.property('timestamp');",
									"            pm.expect(firstBar).to.have.property('open_price');",
									"            pm.expect(firstBar).to.have.property('high_price');",
									"            pm.expect(firstBar).to.have.property('low_price');",
									"            pm.expect(firstBar).to.have.property('close_price');",
									"        });",
									"    }",
									"} else {",
									"    pm.test(\"Request failed as expected\", function () {",
									"        pm.expect(response.success).to.be.false;",
									"        pm.expect(response.error).to.be.a('string');",
									"    });",
									"    console.log(\"‚ùå Request failed:\", response.error);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"symbol\": \"EUR/USD\",\n  \"timeframe\": \"H1\",\n  \"count\": 50,\n  \"price_type\": \"B\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/market/history",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"market",
								"history"
							]
						},
						"description": "Get historical price bars from current time going back in history.\n\n**Authentication Required**: JWT token in Authorization header\n\n**How it works**: Gets current open candle + historical bars going backwards\n\n**Request Parameters**:\n- `symbol` (required): Currency pair (e.g., EUR/USD)\n- `timeframe` (required): S1, S10, M1, M5, M15, M30, H1, H4, D1, W1, MN1\n- `count` (required): Number of bars to retrieve (1-10000)\n- `to_time` (optional): End time for data (defaults to now)\n- `price_type` (optional): \"A\" for Ask, \"B\" for Bid (default: B)\n\n**Examples**:\n- Get last 50 hourly bars: `{\"symbol\": \"EUR/USD\", \"timeframe\": \"H1\", \"count\": 50}`\n- Get last 100 5-min bars: `{\"symbol\": \"EUR/USD\", \"timeframe\": \"M5\", \"count\": 100}`\n\n**Returns**: Array of OHLCV bars with most recent first"
					},
					"response": [
						{
							"name": "Historical Bars - Previous Day",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"symbol\": \"EUR/USD\",\n  \"timeframe\": \"H1\",\n  \"count\": 24,\n  \"to_time\": \"2025-08-27T23:59:59.000000\",\n  \"price_type\": \"B\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{base_url}}/market/history",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"market",
										"history"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"request_id\": \"MHR_1756367918500\",\n    \"symbol\": \"EUR/USD\",\n    \"timeframe\": \"H1\",\n    \"price_type\": \"B\",\n    \"from_time\": \"2025-08-27T00:00:00.000000\",\n    \"to_time\": \"2025-08-27T23:00:00.000000\",\n    \"bars\": [\n        {\n            \"timestamp\": \"2025-08-27T23:00:00.000000\",\n            \"open_price\": 1.08945,\n            \"high_price\": 1.08997,\n            \"low_price\": 1.08923,\n            \"close_price\": 1.08976,\n            \"volume\": 1234,\n            \"volume_ex\": 1234.56\n        },\n        {\n            \"timestamp\": \"2025-08-27T22:00:00.000000\",\n            \"open_price\": 1.08912,\n            \"high_price\": 1.08955,\n            \"low_price\": 1.08901,\n            \"close_price\": 1.08945,\n            \"volume\": 987,\n            \"volume_ex\": 987.65\n        }\n    ],\n    \"message\": \"Retrieved 24 historical bars for EUR/USD\",\n    \"timestamp\": \"2025-08-28T07:58:38.591062\"\n}"
						},
						{
							"name": "Successful Historical Bars",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"symbol\": \"EUR/USD\",\n  \"period_id\": \"H1\",\n  \"max_bars\": 50,\n  \"end_time\": \"2023-12-01T15:30:00.000000\",\n  \"price_type\": \"B\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/market/history",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"market",
										"history"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"request_id\": \"MHR_1640995200000\",\n    \"symbol\": \"EUR/USD\",\n    \"period_id\": \"H1\",\n    \"price_type\": \"B\",\n    \"data_from\": \"2023-11-28T10:00:00.000000\",\n    \"data_to\": \"2023-12-01T15:00:00.000000\",\n    \"all_history_from\": \"2020-01-01T00:00:00.000000\",\n    \"all_history_to\": \"2023-12-01T15:30:00.000000\",\n    \"bars\": [\n        {\n            \"timestamp\": \"2023-12-01T14:00:00.000000\",\n            \"open_price\": 1.08945,\n            \"high_price\": 1.08997,\n            \"low_price\": 1.08923,\n            \"close_price\": 1.08976,\n            \"volume\": 1234,\n            \"volume_ex\": 1234.56\n        },\n        {\n            \"timestamp\": \"2023-12-01T13:00:00.000000\",\n            \"open_price\": 1.08912,\n            \"high_price\": 1.08955,\n            \"low_price\": 1.08901,\n            \"close_price\": 1.08945,\n            \"volume\": 987,\n            \"volume_ex\": 987.65\n        }\n    ],\n    \"message\": \"Retrieved 50 historical bars for EUR/USD\",\n    \"timestamp\": \"2023-12-01T15:30:00Z\"\n}"
						},
						{
							"name": "Invalid Symbol Error",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"symbol\": \"INVALID/SYMBOL\",\n  \"period_id\": \"H1\",\n  \"max_bars\": 10,\n  \"end_time\": \"2023-12-01T15:30:00.000000\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/market/history",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"market",
										"history"
									]
								}
							},
							"status": "Bad Request",
							"code": 400,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"message\": \"Failed to retrieve historical bars\",\n    \"error\": \"Request rejected: unknown symbol (Reason code: 1)\"\n}"
						},
						{
							"name": "Validation Error",
							"originalRequest": {
								"method": "POST",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									},
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"symbol\": \"EUR/USD\",\n  \"period_id\": \"INVALID\",\n  \"max_bars\": 50000\n}"
								},
								"url": {
									"raw": "{{base_url}}/market/history",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"market",
										"history"
									]
								}
							},
							"status": "Unprocessable Entity",
							"code": 422,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"detail\": [\n        {\n            \"loc\": [\"body\", \"period_id\"],\n            \"msg\": \"value is not a valid enumeration member; permitted: 'S1', 'S10', 'M1', 'M5', 'M15', 'M30', 'H1', 'H4', 'D1', 'W1', 'MN1'\",\n            \"type\": \"type_error.enum\"\n        },\n        {\n            \"loc\": [\"body\", \"max_bars\"],\n            \"msg\": \"ensure this value is less than or equal to 10000\",\n            \"type\": \"value_error.number.not_le\"\n        }\n    ]\n}"
						}
					]
				}
			],
			"description": "Market data endpoints for retrieving trading instruments, historical bars, and market information."
		},
		{
			"name": "üîå WebSocket Orderbook",
			"item": [
				{
					"name": "WebSocket Status",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// Test response status",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Parse response",
									"const response = pm.response.json();",
									"",
									"// Test response structure",
									"pm.test(\"Response has required fields\", function () {",
									"    pm.expect(response).to.have.property('success');",
									"    pm.expect(response).to.have.property('user_id');",
									"    pm.expect(response).to.have.property('websocket_connected');",
									"    pm.expect(response).to.have.property('active_subscriptions');",
									"});",
									"",
									"// Log WebSocket status",
									"if (response.success) {",
									"    console.log(\"‚úÖ WebSocket Status Retrieved\");",
									"    console.log(\"üë§ User ID:\", response.user_id);",
									"    console.log(\"üîå WebSocket Connected:\", response.websocket_connected);",
									"    console.log(\"üìä Active Subscriptions:\", response.active_subscriptions.length);",
									"    console.log(\"üåê Total Connections:\", response.total_connections);",
									"    ",
									"    if (response.active_subscriptions.length > 0) {",
									"        console.log(\"üìã Subscribed to:\", response.active_subscriptions.join(', '));",
									"    } else {",
									"        console.log(\"üì≠ No active subscriptions\");",
									"    }",
									"} else {",
									"    console.log(\"‚ùå Failed to get WebSocket status\");",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/ws/orderbook/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"ws",
								"orderbook",
								"status"
							]
						},
						"description": "Get WebSocket connection status and active subscriptions.\n\n**Authentication Required**: JWT token in Authorization header\n\n**Returns**:\n- WebSocket connection status\n- Active orderbook subscriptions\n- Total WebSocket connections\n- User identification"
					},
					"response": [
						{
							"name": "WebSocket Status - Connected",
							"originalRequest": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									}
								],
								"url": {
									"raw": "{{base_url}}/ws/orderbook/status",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"ws",
										"orderbook",
										"status"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"user_id\": \"trader123\",\n    \"websocket_connected\": true,\n    \"active_subscriptions\": [\"EUR/USD\", \"GBP/USD\"],\n    \"total_connections\": 3,\n    \"message\": \"WebSocket status for user trader123\"\n}"
						},
						{
							"name": "WebSocket Status - Not Connected",
							"originalRequest": {
								"method": "GET",
								"header": [
									{
										"key": "Authorization",
										"value": "Bearer {{auth_token}}"
									}
								],
								"url": {
									"raw": "{{base_url}}/ws/orderbook/status",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"ws",
										"orderbook",
										"status"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"success\": true,\n    \"user_id\": \"trader123\",\n    \"websocket_connected\": false,\n    \"active_subscriptions\": [],\n    \"total_connections\": 0,\n    \"message\": \"WebSocket status for user trader123\"\n}"
						}
					]
				},
				{
					"name": "WebSocket Connection Guide",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/docs#/WebSocket",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"docs"
							],
							"hash": "#/WebSocket"
						},
						"description": "**WebSocket Orderbook Connection Guide**\n\n## Connection URL\n```\nws://localhost:8000/ws/orderbook?token=YOUR_JWT_TOKEN\n```\n\n## Message Format\nAll messages are JSON objects with a `type` field:\n\n### Subscribe to Orderbook\n```json\n{\n  \"type\": \"subscribe\",\n  \"symbol\": \"EUR/USD\",\n  \"levels\": 5,\n  \"md_req_id\": \"optional_custom_id\"\n}\n```\n\n### Unsubscribe from Orderbook\n```json\n{\n  \"type\": \"unsubscribe\",\n  \"symbol\": \"EUR/USD\",\n  \"md_req_id\": \"optional_id_to_cancel\"\n}\n```\n\n## Received Messages\n\n### Orderbook Data\n```json\n{\n  \"type\": \"orderbook\",\n  \"symbol\": \"EUR/USD\",\n  \"request_id\": \"OB_EUR/USD_1640995200000\",\n  \"data\": {\n    \"symbol\": \"EUR/USD\",\n    \"timestamp\": \"2023-12-01T10:30:15\",\n    \"best_bid\": 1.08945,\n    \"best_ask\": 1.08955,\n    \"mid_price\": 1.08950,\n    \"spread\": 0.00010,\n    \"spread_bps\": 0.92,\n    \"bids\": [\n      {\"price\": 1.08945, \"size\": 100000, \"level\": 1},\n      {\"price\": 1.08940, \"size\": 200000, \"level\": 2}\n    ],\n    \"asks\": [\n      {\"price\": 1.08955, \"size\": 150000, \"level\": 1},\n      {\"price\": 1.08960, \"size\": 100000, \"level\": 2}\n    ]\n  },\n  \"timestamp\": \"2023-12-01T10:30:15.123456\"\n}\n```\n\n### Success/Error Messages\n```json\n{\n  \"type\": \"success\",\n  \"message\": \"Subscribed to orderbook for EUR/USD\",\n  \"symbol\": \"EUR/USD\",\n  \"md_req_id\": \"OB_EUR/USD_1640995200000\"\n}\n```\n\n```json\n{\n  \"type\": \"error\",\n  \"error\": \"Failed to subscribe to INVALID/SYMBOL: unknown symbol\",\n  \"symbol\": \"INVALID/SYMBOL\"\n}\n```\n\n### Heartbeat\n```json\n{\n  \"type\": \"heartbeat\",\n  \"timestamp\": \"2023-12-01T10:30:15.123456\"\n}\n```\n\n## Recommended WebSocket Clients\n- **Browser**: WebSocket King Chrome Extension\n- **Command Line**: `wscat -c \"ws://localhost:8000/ws/orderbook?token=YOUR_TOKEN\"`\n- **Python**: `websockets` library\n- **JavaScript**: Native WebSocket API\n\n## Features\n- **Real-time Updates**: Live orderbook streaming\n- **Multiple Symbols**: Subscribe to multiple instruments\n- **Automatic Cleanup**: FIX subscriptions cancelled on disconnect\n- **Error Handling**: Comprehensive error messages\n- **Authentication**: JWT token-based security"
					}
				}
			],
			"description": "WebSocket endpoints for real-time orderbook streaming. Use external WebSocket clients to connect and subscribe to live market data."
		},
		{
			"name": "üè• Health & System",
			"item": [
				{
					"name": "Root Endpoint",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const response = pm.response.json();",
									"",
									"pm.test(\"API is running\", function () {",
									"    pm.expect(response.message).to.include(\"running\");",
									"});",
									"",
									"console.log(\"üöÄ API Status:\", response.message);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/",
							"host": [
								"{{base_url}}"
							],
							"path": [
								""
							]
						},
						"description": "Basic API status check - no authentication required."
					},
					"response": [
						{
							"name": "API Running",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/",
									"host": [
										"{{base_url}}"
									],
									"path": [
										""
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"message\": \"FIX API Adapter is running\"\n}"
						}
					]
				},
				{
					"name": "Health Check",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"const response = pm.response.json();",
									"",
									"pm.test(\"Health status is healthy\", function () {",
									"    pm.expect(response.status).to.eql(\"healthy\");",
									"});",
									"",
									"console.log(\"üíö Health Status:\", response.status);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"health"
							]
						},
						"description": "Health check endpoint for monitoring - no authentication required."
					},
					"response": [
						{
							"name": "Healthy",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/health",
									"host": [
										"{{base_url}}"
									],
									"path": [
										"health"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n    \"status\": \"healthy\"\n}"
						}
					]
				},
				{
					"name": "API Documentation",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/docs",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"docs"
							]
						},
						"description": "FastAPI automatic documentation (Swagger UI) - opens in browser."
					}
				}
			],
			"description": "System health and documentation endpoints."
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global pre-request script",
					"console.log(\"üåê Making request to:\", pm.request.url.toString());",
					"",
					"// Check if auth token exists for protected endpoints",
					"const authToken = pm.environment.get(\"auth_token\");",
					"const isProtectedEndpoint = pm.request.url.toString().includes(\"/session\") || pm.request.url.toString().includes(\"/market\") || pm.request.url.toString().includes(\"/ws\");",
					"",
					"if (isProtectedEndpoint && !authToken) {",
					"    console.warn(\"‚ö†Ô∏è  This endpoint requires authentication. Run the Login request first.\");",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Global test script",
					"console.log(\"üì° Response received from:\", pm.request.url.toString());",
					"console.log(\"üìä Response time:\", pm.response.responseTime + \"ms\");",
					"console.log(\"üìã Response size:\", pm.response.responseSize + \" bytes\");",
					"",
					"// Test response time",
					"pm.test(\"Response time is reasonable\", function () {",
					"    pm.expect(pm.response.responseTime).to.be.below(5000);",
					"});",
					"",
					"// Test response format",
					"pm.test(\"Response is JSON\", function () {",
					"    pm.response.to.be.json;",
					"});"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "ws_base_url",
			"value": "ws://localhost:8000",
			"type": "string"
		},
		{
			"key": "username",
			"value": "your_fix_username",
			"type": "string"
		},
		{
			"key": "password",
			"value": "your_fix_password",
			"type": "string"
		},
		{
			"key": "device_id",
			"value": "postman_testing",
			"type": "string"
		}
	]
}
